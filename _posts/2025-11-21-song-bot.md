---
layout: post
title: Song Bot
date: 2025-11-21
author: Paul Berens
tags: ["tech", "music", "product"]
opimage: post_bot.notification.jpg
description: ü§ñ
---
I continue my [vibe coding](/vibe-coding) escapade with my first bot: <a href="https://t.me/pb_song_bot" target="_blank">a song-of-the-day Telegram bot</a> that automatically sends a tasty track to subscribers every morning to enjoy with coffee.

## First the Music
Before any bot building, I spent about a year curating a set of my favorite songs of all time‚Äîa revelatory exercise that surfaced my tastes: lots of classic rock and folk-rock from the '60s-'80s golden era, plus generous helpings of singer-songwriters, soul/R&B, and live tracks. Christmas music (both sacred and secular) bookends the calendar from early December through early January, confirming what I [previously discussed](/xmas-music): I do love the season. I aimed for artist diversity (no more than six tracks each) and gravitate toward deep cuts‚Äîso if you recognize a hit here, it's because it's genuinely great. But as Grandpa Brennan was wont to say, *de gustibus non est disputandum.*

## Bot building
This was a product of Claude (Sonnet 4.5). Admittedly, it didn't get everything perfect on the first pass, but it sure took my abrasive feedback in stride. The process wasn't totally linear, but it went something like this: 
1. Learn about Telegram bots
2. Set up and configure the bot
3. Create the initial daily song workflow
4. Debug some "ES module" issues[^2]
5. Add self-service subscriptions
6. Test and fix
7. Refine (message formatting, etc.)

[^2]: This is the type of arcana that's over my head and so I'm totally reliant on the LLM to diagnose and fix: Node.js was trying to run our script as an ES Module (basically new JavaScript) (which doesn't allow `require()`), but the thing was written in old Javascript (i.e., CommonJS style), so got this error about "require is not defined in ES module scope." So the fix‚Äîafter a number of back-and-forths‚Äîwas renaming the file to `.cjs` (CommonJS file extension) and wrapped the `await` in an async function, which told Node: "Hey, this is old-style CommonJS, not modern ES Modules." ü§ì

<p><img src="/assets/og/post_telegram-workflow.png" alt="Failing Telegram workflows" style="width: 70%;"><span class="muted small">Fail, fail, fail, success, fail, fail...</span></p>

## The Setup
Here's what I ended up with:
1. **Telegram Bot** ‚Äì Created via <a href="https://t.me/BotFather@BotFather" target="_blank">@BotFather</a> w/ token stored as GitHub secret. Users subscribe themselves.
2. **Data Source** (`_data/daily_song.yml`) ‚Äì My impeccably-curated list of 366 songs[^3] with date, track title, artist, and YouTube Music song ID.
  ```YAML
  - date: "11-20"
       track: "Hello City"
       artist: "Barenaked Ladies"
       songId: "0tGT9rONZPs"
  ```
3. **GitHub Actions Workflows**
  - **Workflow #1: Subscription Manager** (`telegram-subscriptions.yml`) ‚Äì Runs daily at 07:00 Pacific, and checks for `/subscribe` and `/unsubscribe` messages, adding/removing users to/from `_data/telegram_subscribers.json`, kicks out confirmation messages. 
  - **Workflow #2: Daily Song Sender** (`telegram-daily-song.yml`) ‚Äì Runs a half hour later (~07:45), reading today's song from YAML, sending the selection with clickable link to the track on YouTube Music to all subscribers in the JSON file:
4. **Rinse and repeat** ‚Äì Repeats daily, fully automated via GitHub Action with no servers or hosting costs.

[^3]: Yes, leap year support built in.

![bot notification](/assets/og/post_bot.notification.jpg)

## You got a few options
1. <a href="https://t.me/pb_song_bot" target="_blank">Subscribe</a> so that we can experience the same songs together on the same days. (Then just sneak out with an `/unsubscribe` if you're not feelin' my jams.)
2. If you're more of *pull* person than a *push* person, you can get the same song of the day via the [today](/today/) page.
3. If you're extra jazzed about bots and motivated, you could make your own SOTD bot by cloning these workflows and `.yml` files from [my GitHub repo](https://github.com/berensp/berensp.github.io/). I'll subscribe.

## Bottom line
It's astonishing that a non-coder like moi can go from idea to fully functional Telegram bot with auto-subscriptions in one sub-100-message chat session‚Äîthat there's some right-fine vibe codin'...at least for the standards of late 2025 (I'm sure it'll seem quaint in a year or two).

‚Äî ·¥ò. ·¥ç.  ô.