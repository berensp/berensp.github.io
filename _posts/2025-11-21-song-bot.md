---
layout: post
title: Song Bot
date: 2025-11-21
author: Paul Berens
tags: ["tech", "music", "product"]
opimage: post_bot.notification.jpg
description: ü§ñ
---
I continue my [vibe coding](/vibe-coding) escapade with my first bot: <a href="https://t.me/pb_song_bot" target="_blank">a song-of-the-day Telegram bot</a> that automatically sends a tasty track to subscribers every day in time for morning coffee (~07:45 Pacific).

## The Curated Song List
Before I get into the bot-vibing, a quick aside on the music selections.

I've been curating this list pretty consistently over the past year, and it's been revealing about my tastes: it skews classic rock and folk-rock from the '60s-'80s golden era, with generous helpings of singer-songwriters, soul/R&B, and live tracks. I tend toward the earnest over the ironic. And then a full month of Christmas/sacred music wraps the year (early December to early January). I went for diversity of artist (i.e., try to limit the number of Beatles and Springsteen tracks), and I've got a proclivity toward deep tracks (i.e., if it's a hit, it made the list because it's golden).

```YAML
- date: "11-20"
  track: "Hello City"
  artist: "Barenaked Ladies"
  songId: "0tGT9rONZPs"
```

## The Process
This was a product of Claude (Sonnet 4.5). Admittedly, it didn't get everything perfect on the first pass, but it sure took my abrasive feedback in stride. The process wasn't totally linear, but it went something like this: 
1. Learn about Telegram bots
2. Set up the bot with @BotFather
3. Create the initial daily song workflow
4. Debug some ES module issues[^2], which took a while
5. Add self-service subscriptions
6. Test and fix
7. Refine (message formatting, etc.)

[^2]: This is the type of thing that's over my head and so I'm totally reliant on the LLM to diagnose and fix: Node.js was trying to run our script as an ES Module (basically new JavaScript) (which doesn't allow `require()`), but the thing was written in old Javascript (i.e., CommonJS style), so got this error about "require is not defined in ES module scope." So the fix was renaming the file to `.cjs` (CommonJS file extension) and wrapped the `await` in an async function, which told Node: "Hey, this is old-style CommonJS, not modern ES Modules." ü§ì

<p><img src="/assets/og/post_telegram-workflow.png" alt="Failing Telegram workflows" width="50%"><span class="muted small">Fail, fail, fail, success, fail, fail...</span></p>

## The Setup
Here's what I ended up with:
1. **Telegram Bot** ‚Äì Created via @BotFather w/ token stored as GitHub secret. Users send `/subscribe` or `/start` to join, and `/unsubscribe` to opt out.
2. **Data Source** (`_data/daily_song.yml`) ‚Äì My impeccably-curated list of 366 songs[^3] with date, track title, artist, and YouTube Music song ID.
3. **GitHub Actions Workflows**
  - **Workflow #1: Subscription Manager** (`telegram-subscriptions.yml`) ‚Äì Runs daily at 07:00 Pacific, and checks for `/subscribe` and `/unsubscribe` messages, adding/removing users from `_data/telegram_subscribers.json`, kicks out confirmation messages. 
  - **Workflow #2: Daily Song Sender** (`telegram-daily-song.yml`) ‚Äì Runs a half hour later (~07:45), reading today's song from YAML, sending to all subscribers in the JSON file (e.g., #325: "Can I Believe You" by Fleet Foxes [with clickable link to the track on YouTube Music])
4. **Rinse and repeat** ‚Äì Repeats daily, fully automated via GitHub Action with no servers or hosting costs.

[^3]: Yes, leap year support built in.

Feel free to <a href="https://t.me/pb_song_bot" target="_blank">test it out</a> and then if our musical tastes aren't matching up, just slip out with an `/unsubscribe`. (The [today](/today/) page has the song of the day, too, if you're more of *pull* person than a *push* person.)

![bot notification](/assets/og/post_bot.notification.jpg)

Bottom line: I got from idea to fully functional Telegram bot with auto-subscriptions in one sub-100-message chat session‚Äîthat there's some right-fine vibe codin'...at least for the standards of late 2025 (I'm sure it'll seem quaint in a year or two).

‚Äî ·¥ò. ·¥ç.  ô.